<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‚ö° SIMULADOR ENERG√âTICO √âPICO ‚ö°</title>
  <!-- Bootstrap 5 CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoY9a6ZQZ1f7QZ9KKm5+qk5iRa9jUM5VnsBfZxOGx+Vf5F2"
    crossorigin="anonymous">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Rajdhani', sans-serif;
      background: #000;
      color: #fff;
      overflow-x: hidden;
      position: relative;
    }
    
    /* MATRIX RAIN BACKGROUND */
    .matrix-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -3;
      background: radial-gradient(ellipse at center, #001122 0%, #000000 100%);
    }
    
    .matrix-rain {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="50" font-size="20" fill="%2300ff41" opacity="0.1">01</text></svg>') repeat;
      animation: matrix-fall 20s linear infinite;
      opacity: 0.3;
    }
    
    @keyframes matrix-fall {
      0% { transform: translateY(-100vh); }
      100% { transform: translateY(100vh); }
    }
    
    /* ANIMATED GRID BACKGROUND */
    .cyber-grid {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      background-image: 
        linear-gradient(rgba(0,255,65,0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,255,65,0.1) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: grid-pulse 4s ease-in-out infinite;
    }
    
    @keyframes grid-pulse {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 0.5; }
    }
    
    /* LASER BEAMS */
    .laser-beam {
      position: absolute;
      height: 2px;
      background: linear-gradient(90deg, transparent, #00ff41, #ff0080, transparent);
      animation: laser-sweep 3s linear infinite;
      box-shadow: 0 0 20px #00ff41, 0 0 40px #ff0080;
    }
    
    @keyframes laser-sweep {
      0% { 
        width: 0; 
        left: -100%;
        opacity: 0;
      }
      20% { 
        opacity: 1;
      }
      80% { 
        opacity: 1;
      }
      100% { 
        width: 100vw; 
        left: 100%;
        opacity: 0;
      }
    }
    
    .laser-1 { top: 20%; animation-delay: 0s; }
    .laser-2 { top: 60%; animation-delay: 1s; }
    .laser-3 { top: 80%; animation-delay: 2s; }
    
    /* HERO SECTION EPIC */
    .hero {
      position: relative;
      height: 100vh;
      background: linear-gradient(45deg, #000428 0%, #004e92 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      margin-bottom: 0;
    }
    
    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(255,0,128,0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 50%, rgba(0,255,65,0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(0,255,255,0.2) 0%, transparent 50%);
      animation: color-dance 8s ease-in-out infinite;
    }
    
    @keyframes color-dance {
      0%, 100% { 
        filter: hue-rotate(0deg) brightness(1); 
      }
      25% { 
        filter: hue-rotate(90deg) brightness(1.2); 
      }
      50% { 
        filter: hue-rotate(180deg) brightness(0.8); 
      }
      75% { 
        filter: hue-rotate(270deg) brightness(1.1); 
      }
    }
    
    .hero-content {
      text-align: center;
      z-index: 10;
      position: relative;
    }
    
    .hero h1 {
      font-family: 'Orbitron', monospace;
      font-size: 4rem;
      font-weight: 900;
      background: linear-gradient(45deg, #00ff41, #ff0080, #00ffff, #ffff00);
      background-size: 400% 400%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradient-text 3s ease-in-out infinite, text-glow 2s ease-in-out infinite;
      text-shadow: 0 0 30px rgba(0,255,65,0.8);
      margin-bottom: 2rem;
      transform: scale(1);
      transition: all 0.3s ease;
    }
    
    .hero h1:hover {
      transform: scale(1.1);
      filter: drop-shadow(0 0 20px #00ff41);
    }
    
    @keyframes gradient-text {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    @keyframes text-glow {
      0%, 100% { text-shadow: 0 0 30px rgba(0,255,65,0.8); }
      50% { text-shadow: 0 0 50px rgba(255,0,128,1), 0 0 80px rgba(0,255,255,0.8); }
    }
    
    .hero .lead {
      font-size: 1.8rem;
      font-weight: 600;
      color: #00ffff;
      text-shadow: 0 0 20px rgba(0,255,255,0.8);
      animation: pulse-glow 3s ease-in-out infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; text-shadow: 0 0 30px rgba(0,255,255,1); }
    }
    
    /* FLOATING PARTICLES */
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #00ff41;
      border-radius: 50%;
      box-shadow: 0 0 10px #00ff41;
      animation: float-particle 6s linear infinite;
    }
    
    @keyframes float-particle {
      0% {
        transform: translateY(100vh) translateX(0) scale(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
        transform: scale(1);
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) translateX(100px) scale(0);
        opacity: 0;
      }
    }
    
    /* MAIN CONTAINER EPIC */
    .main-container {
      position: relative;
      z-index: 5;
      padding: 4rem 2rem;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(20px);
    }
    
    /* EPIC CARDS */
    .card {
      background: linear-gradient(135deg, rgba(0,20,40,0.9) 0%, rgba(0,10,30,0.95) 100%);
      border: 2px solid transparent;
      border-radius: 25px;
      box-shadow: 
        0 0 50px rgba(0,255,65,0.3),
        inset 0 0 50px rgba(0,255,255,0.1);
      backdrop-filter: blur(20px);
      position: relative;
      overflow: hidden;
      transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform: perspective(1000px) rotateX(5deg);
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0,255,65,0.4), transparent);
      transition: left 0.7s ease;
    }
    
    .card:hover::before {
      left: 100%;
    }
    
    .card:hover {
      transform: perspective(1000px) rotateX(0deg) scale(1.05);
      border-color: #00ff41;
      box-shadow: 
        0 0 100px rgba(0,255,65,0.6),
        0 0 200px rgba(255,0,128,0.3),
        inset 0 0 50px rgba(0,255,255,0.2);
    }
    
    .card-body {
      position: relative;
      z-index: 2;
      padding: 2.5rem;
    }
    
    .card-title {
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      font-size: 1.5rem;
      color: #00ff41;
      text-shadow: 0 0 20px rgba(0,255,65,0.8);
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    /* EPIC FORM CONTROLS */
    .form-label {
      font-weight: 600;
      color: #00ffff;
      font-size: 1.1rem;
      text-shadow: 0 0 10px rgba(0,255,255,0.6);
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 0.8rem;
    }
    
    .form-control, .form-select {
      background: rgba(0,20,40,0.8);
      border: 2px solid rgba(0,255,65,0.5);
      border-radius: 15px;
      padding: 15px 20px;
      color: #00ffff;
      font-size: 1.1rem;
      font-weight: 500;
      transition: all 0.4s ease;
      backdrop-filter: blur(10px);
      box-shadow: inset 0 0 20px rgba(0,255,65,0.1);
    }
    
    .form-control:focus, .form-select:focus {
      background: rgba(0,30,60,0.9);
      border-color: #00ff41;
      box-shadow: 
        0 0 30px rgba(0,255,65,0.6),
        inset 0 0 30px rgba(0,255,65,0.2);
      color: #fff;
      transform: scale(1.02);
    }
    
    .form-control:hover, .form-select:hover {
      border-color: #ff0080;
      box-shadow: 0 0 20px rgba(255,0,128,0.4);
    }
    
    /* EPIC BUTTON */
    .btn-primary {
      background: linear-gradient(45deg, #00ff41, #ff0080, #00ffff);
      background-size: 300% 300%;
      border: none;
      border-radius: 20px;
      padding: 20px 40px;
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      font-size: 1.3rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #000;
      box-shadow: 
        0 0 30px rgba(0,255,65,0.6),
        0 10px 30px rgba(0,0,0,0.3);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      animation: button-glow 3s ease-in-out infinite;
      position: relative;
      overflow: hidden;
    }
    
    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.6s ease;
    }
    
    .btn-primary:hover::before {
      left: 100%;
    }
    
    @keyframes button-glow {
      0%, 100% { 
        background-position: 0% 50%;
        box-shadow: 
          0 0 30px rgba(0,255,65,0.6),
          0 10px 30px rgba(0,0,0,0.3);
      }
      50% { 
        background-position: 100% 50%;
        box-shadow: 
          0 0 60px rgba(255,0,128,0.8),
          0 15px 40px rgba(0,0,0,0.5);
      }
    }
    
    .btn-primary:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 
        0 0 80px rgba(0,255,65,1),
        0 20px 50px rgba(255,0,128,0.6);
      background-size: 400% 400%;
      animation-duration: 0.5s;
    }
    
    .btn-primary:active {
      transform: translateY(-2px) scale(1.02);
    }
    
    /* RESULT CARD EPIC */
    .result-card {
      background: linear-gradient(135deg, rgba(20,0,40,0.9) 0%, rgba(40,0,20,0.95) 100%);
      border: 2px solid rgba(255,0,128,0.6);
    }
    
    /* LIST ITEMS EPIC */
    .list-group-item {
      background: rgba(0,20,40,0.8);
      border: 1px solid rgba(0,255,65,0.3);
      border-radius: 15px !important;
      margin-bottom: 12px;
      padding: 15px 20px;
      backdrop-filter: blur(15px);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
      color: #00ffff;
      font-weight: 600;
    }
    
    .list-group-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0,255,65,0.2), transparent);
      transition: left 0.5s ease;
    }
    
    .list-group-item:hover::before {
      left: 100%;
    }
    
    .list-group-item:hover {
      transform: translateX(10px) scale(1.02);
      border-color: #00ff41;
      box-shadow: 
        0 0 30px rgba(0,255,65,0.6),
        0 5px 20px rgba(0,0,0,0.3);
      background: rgba(0,30,60,0.9);
    }
    
    .cost-item {
      border-left: 5px solid #ff0080;
    }
    
    .impact-item {
      border-left: 5px solid #00ff41;
    }
    
    /* BADGES EPIC */
    .badge {  
      font-size: 1rem !important;
      padding: 8px 15px;
      border-radius: 12px;
      font-weight: 700;
      text-shadow: 0 0 10px rgba(0,0,0,0.8);
      animation: badge-pulse 2s ease-in-out infinite;
    }
    
    @keyframes badge-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    /* LOADING ANIMATION EPIC */
    .loading-spinner {
      animation: epic-spin 1s linear infinite;
      color: #00ff41;
      text-shadow: 0 0 20px #00ff41;
    }
    
    @keyframes epic-spin {
      from { 
        transform: rotate(0deg) scale(1);
        color: #00ff41;
      }
      25% {
        color: #ff0080;
        transform: rotate(90deg) scale(1.1);
      }
      50% {
        color: #00ffff;
        transform: rotate(180deg) scale(1);
      }
      75% {
        color: #ffff00;
        transform: rotate(270deg) scale(1.1);
      }
      to { 
        transform: rotate(360deg) scale(1);
        color: #00ff41;
      }
    }
    
    /* ALERT EPIC */
    .alert {
      background: rgba(20,0,0,0.9);
      border: 2px solid #ff0080;
      border-radius: 15px;
      backdrop-filter: blur(20px);
      color: #ff0080;
      font-weight: 600;
      box-shadow: 0 0 30px rgba(255,0,128,0.4);
    }
    
    /* ICONS ANIMATIONS */
    .bi {
      transition: all 0.3s ease;
    }
    
    .bi:hover {
      transform: scale(1.2) rotate(10deg);
      filter: drop-shadow(0 0 10px currentColor);
    }
    
    /* SOUND EFFECT STYLES */
    .sound-trigger {
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .sound-trigger:hover {
      animation: sound-wave 0.6s ease-in-out;
    }
    
    @keyframes sound-wave {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.05); }
      50% { transform: scale(1.1); }
      75% { transform: scale(1.05); }
    }
    
    /* SCROLL ANIMATIONS */
    @keyframes slideInFromLeft {
      0% {
        transform: translateX(-100%);
        opacity: 0;
      }
      100% {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideInFromRight {
      0% {
        transform: translateX(100%);
        opacity: 0;
      }
      100% {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    .animate-left {
      animation: slideInFromLeft 1s ease-out;
    }
    
    .animate-right {
      animation: slideInFromRight 1s ease-out;
    }
    
    /* EXPLOSION EFFECTS */
    .explosion {
      position: absolute;
      width: 100px;
      height: 100px;
      background: radial-gradient(circle, #ff0080 0%, #00ff41 50%, transparent 100%);
      border-radius: 50%;
      opacity: 0;
      pointer-events: none;
      animation: explode 0.6s ease-out;
    }
    
    @keyframes explode {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(3);
        opacity: 0;
      }
    }
    
    /* RESPONSIVE DESIGN */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2.5rem;
      }
      
      .hero .lead {
        font-size: 1.3rem;
      }
      
      .card {
        margin: 10px 0;
      }
      
      .main-container {
        padding: 2rem 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Matrix Background -->
  <div class="matrix-bg">
    <div class="matrix-rain"></div>
  </div>
  
  <!-- Cyber Grid -->
  <div class="cyber-grid"></div>
  
  <!-- Laser Beams -->
  <div class="laser-beam laser-1"></div>
  <div class="laser-beam laser-2"></div>
  <div class="laser-beam laser-3"></div>

  <!-- Hero Section EPIC -->
  <section class="hero">
    <div class="hero-content">
      <h1 class="sound-trigger">‚ö° SIMULADOR ENERG√âTICO √âPICO ‚ö°</h1>
      <p class="lead sound-trigger">üöÄ DOMINA LA ENERG√çA DEL FUTURO üöÄ</p>
      <div class="mt-4">
        <i class="bi bi-lightning-fill" style="font-size: 3rem; color: #00ff41; margin: 0 20px; animation: pulse-glow 2s infinite;"></i>
        <i class="bi bi-cpu-fill" style="font-size: 3rem; color: #ff0080; margin: 0 20px; animation: pulse-glow 2s infinite 0.5s;"></i>
        <i class="bi bi-rocket-takeoff-fill" style="font-size: 3rem; color: #00ffff; margin: 0 20px; animation: pulse-glow 2s infinite 1s;"></i>
      </div>
    </div>
  </section>

  <div class="container main-container px-4">
    <div class="row gx-5">
      <!-- Form Column -->
      <div class="col-lg-5 mb-4 animate-left">
        <div class="card shadow-sm sound-trigger">
          <div class="card-body">
            <h5 class="card-title">
              <i class="bi bi-sliders text-primary"></i>
              üéõÔ∏è CENTRO DE CONTROL √âPICO
            </h5>
            <form id="sim-form" class="row g-4">
              <div class="col-12">
                <label for="pais" class="form-label sound-trigger">
                  <i class="bi bi-globe-americas text-success"></i>
                  üåç ZONA DE OPERACIONES
                </label>
                <select id="pais" name="pais" class="form-select sound-trigger" required>
                  <option value="">üåç -- Selecciona tu territorio --</option>
              {% for p in paises %}
                <option value="{{ p }}" {% if datos and datos.pais == p %}selected{% endif %}>{{ p }}</option>
              {% endfor %}
                </select>
              </div>
              <div class="col-md-6">
                <label for="year" class="form-label sound-trigger">
                  <i class="bi bi-calendar3 text-info"></i>
                  üìÖ A√ëO OBJETIVO
                </label>
                <input type="number" id="year" name="year" class="form-control sound-trigger" value="2020" min="1900" max="2100" required>
              </div>
              <div class="col-md-6">
                <label for="datacenters" class="form-label sound-trigger">
                  <i class="bi bi-hdd-rack text-primary"></i>
                  üè¢ DATACENTERS
                </label>
                <input type="number" id="datacenters" name="datacenters" class="form-control sound-trigger" value="0" min="0">
              </div>
              <div class="col-md-6">
                <label for="dc_capacity_kw" class="form-label sound-trigger">
                  <i class="bi bi-cpu text-warning"></i>
                  ‚ö° POTENCIA DC (kW)
                </label>
                <input type="number" id="dc_capacity_kw" name="dc_capacity_kw" class="form-control sound-trigger" value="1000" min="0" step="any">
              </div>
              <div class="col-md-6">
                <label for="powerplants" class="form-label sound-trigger">
                  <i class="bi bi-building text-danger"></i>
                  üè≠ CENTRALES
                </label>
                <input type="number" id="powerplants" name="powerplants" class="form-control sound-trigger" value="0" min="0">
              </div>
              <div class="col-md-6">
                <label for="pp_capacity_kw" class="form-label sound-trigger">
                  <i class="bi bi-lightning-charge text-success"></i>
                  ‚ö° POTENCIA PP (kW)
                </label>
                <input type="number" id="pp_capacity_kw" name="pp_capacity_kw" class="form-control sound-trigger" value="500000" min="0" step="any">
              </div>
              <div class="col-12">
                <button type="submit" class="btn btn-primary w-100 sound-trigger">
                  <i class="bi bi-rocket-takeoff-fill me-2"></i>
                  üöÄ INICIAR SIMULACI√ìN √âPICA üöÄ
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Result Column -->
      <div class="col-lg-7 animate-right">
        <div id="result" class="card shadow-sm h-100">
          <div class="card-body">
            <h5 class="card-title">
              <i class="bi bi-graph-up text-success"></i>
              üìä PANEL DE RESULTADOS √âPICOS
            </h5>
            <div class="text-center py-5">
              <div style="font-size: 5rem; margin-bottom: 2rem;">
                <i class="bi bi-lightning-fill" style="color: #00ff41; animation: pulse-glow 2s infinite;"></i>
                <i class="bi bi-cpu-fill" style="color: #ff0080; animation: pulse-glow 2s infinite 0.3s;"></i>
                <i class="bi bi-building" style="color: #00ffff; animation: pulse-glow 2s infinite 0.6s;"></i>
              </div>
              <h4 style="color: #00ff41; text-shadow: 0 0 20px #00ff41;">üí° ESPERANDO √ìRDENES</h4>
              <p class="text-muted">Los datos aparecer√°n aqu√≠ al completar la simulaci√≥n</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Particles -->
  <script>
    // Create floating particles
    function createParticle() {
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = Math.random() * 100 + 'vw';
      particle.style.animationDelay = Math.random() * 6 + 's';
      particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
      document.body.appendChild(particle);
      
      setTimeout(() => {
        particle.remove();
      }, 6000);
    }
    
    setInterval(createParticle, 200);
  </script>

  <!-- Bootstrap JS Bundle -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+q2m5Z5U5Eym4u0s5YFjK+p0I7wYF"
    crossorigin="anonymous"></script>
  
  <script>
    // EPIC SOUND EFFECTS (Web Audio API)
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    function playEpicSound(frequency, duration, type = 'sine') {
      try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
        oscillator.type = type;
        
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration);
      } catch (e) {
        // Silently handle audio context issues
      }
    }
    
    function playLaserSound() {
      playEpicSound(800, 0.3, 'sawtooth');
      setTimeout(() => playEpicSound(400, 0.2, 'square'), 100);
    }
    
    function playExplosionSound() {
      playEpicSound(100, 0.5, 'sawtooth');
      setTimeout(() => playEpicSound(50, 0.3, 'triangle'), 200);
    }
    
    function playHoverSound() {
      playEpicSound(600, 0.1, 'sine');
    }
    
    function playClickSound() {
      playEpicSound(1000, 0.1, 'square');
      setTimeout(() => playEpicSound(1200, 0.1, 'sine'), 50);
    }
    
    // Create explosion effect
    function createExplosion(x, y) {
      const explosion = document.createElement('div');
      explosion.className = 'explosion';
      explosion.style.left = (x - 50) + 'px';
      explosion.style.top = (y - 50) + 'px';
      document.body.appendChild(explosion);
      
      playExplosionSound();
      
      setTimeout(() => {
        explosion.remove();
      }, 600);
    }
    
    // Add epic sound effects to elements
    document.addEventListener('DOMContentLoaded', function() {
      // Add hover sounds
      document.querySelectorAll('.sound-trigger').forEach(element => {
        element.addEventListener('mouseenter', () => {
          playHoverSound();
        });
        
        element.addEventListener('click', (e) => {
          playClickSound();
          if (element.tagName === 'BUTTON') {
            createExplosion(e.clientX, e.clientY);
          }
        });
      });
      
      // Add laser sounds to form inputs
      document.querySelectorAll('.form-control, .form-select').forEach(element => {
        element.addEventListener('focus', () => {
          playLaserSound();
        });
      });
    });
    
    // ORIGINAL FORM LOGIC (UNCHANGED)
    document.getElementById('sim-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      const form = e.target;
      const data = {
        pais: form.pais.value,
        year: parseInt(form.year.value, 10),
        datacenters: parseInt(form.datacenters.value, 10),
        dc_capacity_kw: parseFloat(form.dc_capacity_kw.value),
        powerplants: parseInt(form.powerplants.value, 10),
        pp_capacity_kw: parseFloat(form.pp_capacity_kw.value)
      };

      const resultDiv = document.getElementById('result').querySelector('.card-body');
      
      // EPIC LOADING ANIMATION
      resultDiv.innerHTML = `
        <h5 class="card-title">
          <i class="bi bi-graph-up text-success"></i>
          üìä PANEL DE RESULTADOS √âPICOS
        </h5>
        <div class="text-center py-5">
          <div style="font-size: 4rem; margin-bottom: 2rem;">
            <i class="bi bi-arrow-clockwise loading-spinner"></i>
          </div>
          <h4 style="color: #00ff41; text-shadow: 0 0 20px #00ff41;">‚ö° PROCESANDO DATOS √âPICOS...</h4>
          <p style="color: #00ffff;">üöÄ Analizando el poder energ√©tico del futuro</p>
          <div style="margin-top: 2rem;">
            <div style="display: inline-block; margin: 0 10px;">
              <i class="bi bi-lightning-fill" style="font-size: 2rem; color: #00ff41; animation: pulse-glow 1s infinite;"></i>
            </div>
            <div style="display: inline-block; margin: 0 10px;">
              <i class="bi bi-cpu-fill" style="font-size: 2rem; color: #ff0080; animation: pulse-glow 1s infinite 0.3s;"></i>
            </div>
            <div style="display: inline-block; margin: 0 10px;">
              <i class="bi bi-building" style="font-size: 2rem; color: #00ffff; animation: pulse-glow 1s infinite 0.6s;"></i>
            </div>
          </div>
        </div>
      `;

      // Play epic loading sound sequence
      playLaserSound();
      setTimeout(() => playEpicSound(1200, 0.2, 'sine'), 300);
      setTimeout(() => playEpicSound(1500, 0.2, 'triangle'), 600);

      try {
        const resp = await fetch('/api/simulate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const json = await resp.json();

        if (!resp.ok) {
          // EPIC ERROR DISPLAY
          resultDiv.innerHTML = `
            <h5 class="card-title">
              <i class="bi bi-graph-up text-success"></i>
              üìä PANEL DE RESULTADOS √âPICOS
            </h5>
            <div class="alert alert-danger sound-trigger">
              <div style="text-align: center; margin-bottom: 1rem;">
                <i class="bi bi-exclamation-triangle-fill" style="font-size: 3rem; color: #ff0080; animation: pulse-glow 1s infinite;"></i>
              </div>
              <h5 style="text-align: center; color: #ff0080;">‚ö†Ô∏è ERROR EN LA MATRIX ‚ö†Ô∏è</h5>
              <p style="text-align: center; margin: 0;">${json.error || 'Error desconocido en el sistema'}</p>
            </div>
          `;
          playExplosionSound();
          return;
        }

        // EPIC SUCCESS DISPLAY
        let html = `
          <h5 class="card-title">
            <i class="bi bi-graph-up text-success"></i>
            üìä PANEL DE RESULTADOS √âPICOS
          </h5>
          <div class="row mb-4">
            <div class="col-12">
              <h5 style="color: #00ff41; text-shadow: 0 0 20px #00ff41; margin-bottom: 2rem; text-align: center;">
                <i class="bi bi-currency-dollar" style="animation: pulse-glow 2s infinite;"></i> 
                üí∞ AN√ÅLISIS FINANCIERO √âPICO üí∞
              </h5>
              <ul class="list-group">
                <li class="list-group-item cost-item d-flex justify-content-between align-items-center sound-trigger">
                  <span>
                    <i class="bi bi-hdd-rack text-primary me-2" style="font-size: 1.2rem;"></i>
                    <strong>üè¢ DATACENTERS SUPREMOS</strong>
                  </span>
                  <span class="badge bg-primary rounded-pill" style="background: linear-gradient(45deg, #00ff41, #00ffff) !important; color: #000; font-weight: 700;">
                    ${json.coste_datacenters.toFixed(2)} ‚Ç¨
                  </span>
                </li>
                <li class="list-group-item cost-item d-flex justify-content-between align-items-center sound-trigger">
                  <span>
                    <i class="bi bi-building text-danger me-2" style="font-size: 1.2rem;"></i>
                    <strong>üè≠ CENTRALES DE PODER</strong>
                  </span>
                  <span class="badge bg-danger rounded-pill" style="background: linear-gradient(45deg, #ff0080, #ff4444) !important; color: #fff; font-weight: 700;">
                    ${json.coste_powerplants.toFixed(2)} ‚Ç¨
                  </span>
                </li>
              </ul>
            </div>
          </div>
          
          <div class="row">
            <div class="col-12">
              <h5 style="color: #ff0080; text-shadow: 0 0 20px #ff0080; margin-bottom: 2rem; text-align: center;">
                <i class="bi bi-lightning-fill" style="animation: pulse-glow 2s infinite;"></i> 
                ‚ö° DOMINIO ENERG√âTICO TOTAL ‚ö°
              </h5>
              <ul class="list-group">
                <li class="list-group-item impact-item d-flex justify-content-between align-items-center sound-trigger">
                  <span>
                    <i class="bi bi-arrow-down-circle text-danger me-2" style="font-size: 1.2rem;"></i>
                    <strong>‚¨áÔ∏è CONSUMO DC (MWh)</strong>
                  </span>
                  <span class="badge bg-warning rounded-pill" style="background: linear-gradient(45deg, #ffaa00, #ff6600) !important; color: #000; font-weight: 700;">
                    ${json.impact.datacenters_mwh.toFixed(2)}
                  </span>
                </li>
                <li class="list-group-item impact-item d-flex justify-content-between align-items-center sound-trigger">
                  <span>
                    <i class="bi bi-arrow-up-circle text-success me-2" style="font-size: 1.2rem;"></i>
                    <strong>‚¨ÜÔ∏è PRODUCCI√ìN PP (MWh)</strong>
                  </span>
                  <span class="badge bg-success rounded-pill" style="background: linear-gradient(45deg, #00ff41, #00aa22) !important; color: #000; font-weight: 700;">
                    ${json.impact.powerplants_mwh.toFixed(2)}
                  </span>
                </li>
                <li class="list-group-item impact-item d-flex justify-content-between align-items-center sound-trigger">
                  <span>
                    <i class="bi bi-graph-up text-info me-2" style="font-size: 1.2rem;"></i>
                    <strong>üìà BALANCE NETO (MWh)</strong>
                  </span>
                  <span class="badge bg-info rounded-pill" style="background: linear-gradient(45deg, #00ffff, #0088cc) !important; color: #000; font-weight: 700;">
                    ${json.impact.net_mwh.toFixed(2)}
                  </span>
                </li>
                <li class="list-group-item impact-item d-flex justify-content-between align-items-center sound-trigger">
                  <span>
                    <i class="bi bi-speedometer2 text-secondary me-2" style="font-size: 1.2rem;"></i>
                    <strong>üöÄ BALANCE NETO (PJ)</strong>
                  </span>
                  <span class="badge bg-secondary rounded-pill" style="background: linear-gradient(45deg, #aa00ff, #6600cc) !important; color: #fff; font-weight: 700;">
                    ${json.impact.net_pj.toExponential(2)}
                  </span>
                </li>
              </ul>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 3rem; padding: 2rem; background: rgba(0,255,65,0.1); border-radius: 20px; border: 2px solid rgba(0,255,65,0.3);">
            <h4 style="color: #00ff41; text-shadow: 0 0 20px #00ff41; margin-bottom: 1rem;">
              üéâ SIMULACI√ìN COMPLETADA CON √âXITO üéâ
            </h4>
            <div>
              <i class="bi bi-check-circle-fill" style="font-size: 3rem; color: #00ff41; animation: pulse-glow 2s infinite;"></i>
            </div>
          </div>
        `;
        
        resultDiv.innerHTML = html;
        
        // Play success sound sequence
        playEpicSound(800, 0.3, 'sine');
        setTimeout(() => playEpicSound(1000, 0.3, 'sine'), 200);
        setTimeout(() => playEpicSound(1200, 0.5, 'sine'), 400);
        
        // Add sound effects to new elements
        resultDiv.querySelectorAll('.sound-trigger').forEach(element => {
          element.addEventListener('mouseenter', () => {
            playHoverSound();
          });
        });
        
      } catch (err) {
        // EPIC CONNECTION ERROR
        resultDiv.innerHTML = `
          <h5 class="card-title">
            <i class="bi bi-graph-up text-success"></i>
            üìä PANEL DE RESULTADOS √âPICOS
          </h5>
          <div class="alert alert-danger">
            <div style="text-align: center; margin-bottom: 1rem;">
              <i class="bi bi-wifi-off" style="font-size: 3rem; color: #ff0080; animation: pulse-glow 1s infinite;"></i>
            </div>
            <h5 style="text-align: center; color: #ff0080;">üîå CONEXI√ìN PERDIDA EN EL CIBERESPACIO üîå</h5>
            <p style="text-align: center; margin: 0;">Error: ${err.message}</p>
          </div>
        `;
        playExplosionSound();
      }
    });
    
    // EPIC SCROLL ANIMATIONS
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);
    
    // Observe all cards for scroll animations
    document.querySelectorAll('.card').forEach(card => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(50px)';
      card.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
      observer.observe(card);
    });
    
    // EPIC TYPING EFFECT FOR HERO
    function typeText(element, text, speed = 100) {
      element.innerHTML = '';
      let i = 0;
      const timer = setInterval(() => {
        if (i < text.length) {
          element.innerHTML += text.charAt(i);
          i++;
        } else {
          clearInterval(timer);
        }
      }, speed);
    }
    
    // Initialize epic effects
    window.addEventListener('load', () => {
      // Add some initial epic sounds
      setTimeout(() => playLaserSound(), 1000);
      setTimeout(() => playEpicSound(1500, 0.5, 'sine'), 2000);
    });
    
    // Add random laser effects
    setInterval(() => {
      if (Math.random() < 0.1) { // 10% chance every interval
        playEpicSound(Math.random() * 1000 + 500, 0.2, 'sawtooth');
      }
    }, 3000);
  </script>
</body>
</html>